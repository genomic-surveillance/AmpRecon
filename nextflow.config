includeConfig './containers.config'
includeConfig './profiles.config'

params {
    // -------| absolutely required | -----------------------------------
    execution_mode = null // ["in-country", "irods"]

    // --> required for In Country
    run_id = null
    bcl_dir = null
    lane = null
    study_name = null
    read_group = null
    library = null

    // --> required for iRODS
    irods_manifest = null

    // S3 settings ------------------------------------------------------------
    download_from_s3 = false
    bcl_id=null           //"21045"
    s3_bucket_input=null  //"amplicon-test-data"

    upload_to_s3 = false 
    s3_bucket_output=null //"amplicon-test-data"
    
    // -------| params with default values | -----------------------------------
    results_dir = "$launchDir/output/"

    // -------| optional params | --------------------------------------------
    // --- pannel settings ----------------------------------------------------
    pannels_settings = null //"$projectDir/pannels_resources/pannels_settings.csv"
}


profiles {

  standard {
    singularity {
      enabled = true
    }
  }

  sanger_default {

        docker {
            enabled = false
        }

        singularity {
            enabled = true
            autoMounts = true
            cacheDir = "$PWD"
            runOptions = "--bind /lustre,/nfs,/software"
        }

        process {
            cpus = 1
            memory = "8GB"
            errorStrategy = {task.attempt <= 2 ? "retry" : "terminate"}
            maxRetries = 5

            // This is needed to make resume use the cache for the decode step
            withName: decode {
                cache = "deep"
            }
        }

        executor {
            name = "local"
        }
    }
}
